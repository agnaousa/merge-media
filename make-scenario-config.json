{
  "name": "Media Merge Automation - Single Module",
  "description": "Single module to merge audio and video files and return the merged video URL",
  "modules": [
    {
      "id": 1,
      "name": "Merge Media and Return URL",
      "type": "http",
      "config": {
        "description": "Triggers GitHub Action to merge video/audio and returns the merged video download URL",
        "url": "https://api.github.com/repos/agnaousa/merge-media/dispatches",
        "method": "POST",
        "headers": {
          "Authorization": "Bearer {{github_token}}",
          "Accept": "application/vnd.github.v3+json",
          "Content-Type": "application/json"
        },
        "body": {
          "type": "json",
          "data": {
            "event_type": "merge-media",
            "client_payload": {
              "video_path": "{{video_url}}",
              "audio_path": "{{audio_url}}",
              "output_path": "output/merged_{{formatDate(now, 'YYYY-MM-DD_HH-mm-ss')}}.mp4",
              "audio_handling": "{{audio_handling}}",
              "return_url": "true"
            }
          }
        },
        "follow_up": {
          "wait_for_completion": true,
          "check_interval": 30,
          "max_wait_time": 600,
          "return_artifact_url": true
        }
      }
    }
  ],
  "connections": [],
  "settings": {
    "variables": {
      "github_token": {
        "type": "secret",
        "description": "GitHub Personal Access Token with repo permissions"
      },
      "video_url": {
        "type": "string",
        "description": "Direct URL to the video file or path in repository"
      },
      "audio_url": {
        "type": "string", 
        "description": "Direct URL to the audio file or path in repository"
      },
      "audio_handling": {
        "type": "string",
        "default": "replace",
        "description": "How to handle audio: 'replace', 'mix', or 'keep_original'"
      }
    }
  },
  "input_fields": [
    {
      "name": "video_url",
      "label": "Video URL/Path",
      "type": "text",
      "required": true,
      "description": "URL or repository path to the video file"
    },
    {
      "name": "audio_url", 
      "label": "Audio URL/Path",
      "type": "text",
      "required": true,
      "description": "URL or repository path to the audio file"
    },
    {
      "name": "audio_handling",
      "label": "Audio Handling",
      "type": "select",
      "required": false,
      "default": "replace",
      "options": [
        {"value": "replace", "label": "Replace original audio"},
        {"value": "mix", "label": "Mix with original audio"},
        {"value": "keep_original", "label": "Keep original audio only"}
      ]
    }
  ],
  "output_fields": [
    {
      "name": "merged_video_url",
      "label": "Merged Video URL", 
      "type": "url",
      "description": "Direct download URL for the merged video file"
    },
    {
      "name": "status",
      "label": "Processing Status",
      "type": "text",
      "description": "Status of the merge operation"
    },
    {
      "name": "processing_time",
      "label": "Processing Time (seconds)",
      "type": "number",
      "description": "Time taken to process the merge"
    }
  ],
  "usage": {
    "description": "Single module that handles the complete merge process and returns the merged video URL",
    "steps": [
      "1. Provide video_url and audio_url (can be direct URLs or repository paths)",
      "2. Optionally specify audio_handling method",
      "3. Module triggers GitHub Action and waits for completion",
      "4. Returns direct download URL for the merged video"
    ]
  },
  "error_handling": {
    "on_error": "return_error_details",
    "timeout": 600,
    "retry_on_failure": false
  }
}